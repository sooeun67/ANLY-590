<!DOCTYPE html><html><head>
      <title>hw1</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({"extensions":["tex2jax.js"],"jax":["input/TeX","output/HTML-CSS"],"messageStyle":"none","tex2jax":{"processEnvironments":false,"processEscapes":true,"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"TeX":{"extensions":["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},"HTML-CSS":{"availableFonts":["TeX"]}});
        </script>
        <script type="text/javascript" async src="file:///C:\Users\Jay\.atom\packages\markdown-preview-enhanced\node_modules\@shd101wyy\mume\dependencies\mathjax\MathJax.js" charset="UTF-8"></script>
        
      
      
      
      
      
      
      
      
      

      <style> 
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="assignment-1">Assignment 1</h1>

<h4 class="mume-header" id="sooeun-oh">Sooeun Oh</h4>

<h5 class="mume-header" id="october-8-2018">October 8, 2018</h5>

<h3 class="mume-header" id="problem-1">Problem 1</h3>

<p><strong>1.</strong> ANN with 2 inputs, 2 hidden layers, and 3 outputs:</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: G Pages: 1 -->
<svg width="461pt" height="245pt" viewBox="0.00 0.00 461.00 245.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 241)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-241 457,-241 457,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster0</title>
<polygon fill="none" stroke="#ffc0cb" points="8,-44 8,-193 60,-193 60,-44 8,-44"/>
<text text-anchor="middle" x="34" y="-176.4" font-family="Times,serif" font-size="14.00" fill="#000000">Input</text>
</g>
<g id="clust2" class="cluster">
<title>cluster1</title>
<polygon fill="none" stroke="#87ceeb" points="102,-8 102,-229 205,-229 205,-8 102,-8"/>
<text text-anchor="middle" x="153.5" y="-212.4" font-family="Times,serif" font-size="14.00" fill="#000000">Hidden Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster2</title>
<polygon fill="none" stroke="#87ceeb" points="247,-44 247,-193 350,-193 350,-44 247,-44"/>
<text text-anchor="middle" x="298.5" y="-176.4" font-family="Times,serif" font-size="14.00" fill="#000000">Hidden Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster3</title>
<polygon fill="none" stroke="#4eee94" points="392,-8 392,-229 446,-229 446,-8 392,-8"/>
<text text-anchor="middle" x="419" y="-212.4" font-family="Times,serif" font-size="14.00" fill="#000000">Output</text>
</g>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="none" stroke="#000000" cx="34" cy="-142" rx="18" ry="18"/>
<text text-anchor="middle" x="34" y="-137.8" font-family="Times,serif" font-size="14.00" fill="#000000">x1</text>
</g>
<!-- h11 -->
<g id="node3" class="node">
<title>h11</title>
<ellipse fill="none" stroke="#000000" cx="153" cy="-34" rx="18" ry="18"/>
<text text-anchor="middle" x="153" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">h13</text>
</g>
<!-- x1&#45;&gt;h11 -->
<g id="edge1" class="edge">
<title>x1-&gt;h11</title>
<path fill="none" stroke="#000000" d="M47.6508,-129.611C68.2742,-110.894 107.5443,-75.2539 131.8774,-53.1701"/>
<polygon fill="#000000" stroke="#000000" points="134.4555,-55.5568 139.5084,-46.2445 129.7511,-50.3733 134.4555,-55.5568"/>
</g>
<!-- h12 -->
<g id="node4" class="node">
<title>h12</title>
<ellipse fill="none" stroke="#000000" cx="153" cy="-178" rx="18" ry="18"/>
<text text-anchor="middle" x="153" y="-173.8" font-family="Times,serif" font-size="14.00" fill="#000000">h11</text>
</g>
<!-- x1&#45;&gt;h12 -->
<g id="edge2" class="edge">
<title>x1-&gt;h12</title>
<path fill="none" stroke="#000000" d="M51.3036,-147.2347C70.8687,-153.1536 102.9751,-162.8664 125.8782,-169.7951"/>
<polygon fill="#000000" stroke="#000000" points="125.0904,-173.2134 135.6755,-172.759 127.1174,-166.5132 125.0904,-173.2134"/>
</g>
<!-- h13 -->
<g id="node5" class="node">
<title>h13</title>
<ellipse fill="none" stroke="#000000" cx="153" cy="-106" rx="18" ry="18"/>
<text text-anchor="middle" x="153" y="-101.8" font-family="Times,serif" font-size="14.00" fill="#000000">h12</text>
</g>
<!-- x1&#45;&gt;h13 -->
<g id="edge3" class="edge">
<title>x1-&gt;h13</title>
<path fill="none" stroke="#000000" d="M51.3036,-136.7653C70.8687,-130.8464 102.9751,-121.1336 125.8782,-114.2049"/>
<polygon fill="#000000" stroke="#000000" points="127.1174,-117.4868 135.6755,-111.241 125.0904,-110.7866 127.1174,-117.4868"/>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="none" stroke="#000000" cx="34" cy="-70" rx="18" ry="18"/>
<text text-anchor="middle" x="34" y="-65.8" font-family="Times,serif" font-size="14.00" fill="#000000">x2</text>
</g>
<!-- x2&#45;&gt;h11 -->
<g id="edge4" class="edge">
<title>x2-&gt;h11</title>
<path fill="none" stroke="#000000" d="M51.3036,-64.7653C70.8687,-58.8464 102.9751,-49.1336 125.8782,-42.2049"/>
<polygon fill="#000000" stroke="#000000" points="127.1174,-45.4868 135.6755,-39.241 125.0904,-38.7866 127.1174,-45.4868"/>
</g>
<!-- x2&#45;&gt;h12 -->
<g id="edge5" class="edge">
<title>x2-&gt;h12</title>
<path fill="none" stroke="#000000" d="M47.6508,-82.389C68.2742,-101.106 107.5443,-136.7461 131.8774,-158.8299"/>
<polygon fill="#000000" stroke="#000000" points="129.7511,-161.6267 139.5084,-165.7555 134.4555,-156.4432 129.7511,-161.6267"/>
</g>
<!-- x2&#45;&gt;h13 -->
<g id="edge6" class="edge">
<title>x2-&gt;h13</title>
<path fill="none" stroke="#000000" d="M51.3036,-75.2347C70.8687,-81.1536 102.9751,-90.8664 125.8782,-97.7951"/>
<polygon fill="#000000" stroke="#000000" points="125.0904,-101.2134 135.6755,-100.759 127.1174,-94.5132 125.0904,-101.2134"/>
</g>
<!-- h21 -->
<g id="node6" class="node">
<title>h21</title>
<ellipse fill="none" stroke="#000000" cx="298" cy="-142" rx="18" ry="18"/>
<text text-anchor="middle" x="298" y="-137.8" font-family="Times,serif" font-size="14.00" fill="#000000">h21</text>
</g>
<!-- h11&#45;&gt;h21 -->
<g id="edge7" class="edge">
<title>h11-&gt;h21</title>
<path fill="none" stroke="#000000" d="M167.7013,-44.95C192.9959,-63.79 244.9264,-102.4693 275.0297,-124.8911"/>
<polygon fill="#000000" stroke="#000000" points="273.1492,-127.8546 283.2598,-131.0211 277.3306,-122.2406 273.1492,-127.8546"/>
</g>
<!-- h22 -->
<g id="node7" class="node">
<title>h22</title>
<ellipse fill="none" stroke="#000000" cx="298" cy="-70" rx="18" ry="18"/>
<text text-anchor="middle" x="298" y="-65.8" font-family="Times,serif" font-size="14.00" fill="#000000">h22</text>
</g>
<!-- h11&#45;&gt;h22 -->
<g id="edge8" class="edge">
<title>h11-&gt;h22</title>
<path fill="none" stroke="#000000" d="M170.4904,-38.3424C195.3118,-44.505 241.002,-55.8488 270.4161,-63.1516"/>
<polygon fill="#000000" stroke="#000000" points="269.8988,-66.6294 280.4476,-65.6422 271.5856,-59.8356 269.8988,-66.6294"/>
</g>
<!-- h12&#45;&gt;h21 -->
<g id="edge9" class="edge">
<title>h12-&gt;h21</title>
<path fill="none" stroke="#000000" d="M170.4904,-173.6576C195.3118,-167.495 241.002,-156.1512 270.4161,-148.8484"/>
<polygon fill="#000000" stroke="#000000" points="271.5856,-152.1644 280.4476,-146.3578 269.8988,-145.3706 271.5856,-152.1644"/>
</g>
<!-- h12&#45;&gt;h22 -->
<g id="edge10" class="edge">
<title>h12-&gt;h22</title>
<path fill="none" stroke="#000000" d="M167.7013,-167.05C192.9959,-148.21 244.9264,-109.5307 275.0297,-87.1089"/>
<polygon fill="#000000" stroke="#000000" points="277.3306,-89.7594 283.2598,-80.9789 273.1492,-84.1454 277.3306,-89.7594"/>
</g>
<!-- h13&#45;&gt;h21 -->
<g id="edge11" class="edge">
<title>h13-&gt;h21</title>
<path fill="none" stroke="#000000" d="M170.4904,-110.3424C195.3118,-116.505 241.002,-127.8488 270.4161,-135.1516"/>
<polygon fill="#000000" stroke="#000000" points="269.8988,-138.6294 280.4476,-137.6422 271.5856,-131.8356 269.8988,-138.6294"/>
</g>
<!-- h13&#45;&gt;h22 -->
<g id="edge12" class="edge">
<title>h13-&gt;h22</title>
<path fill="none" stroke="#000000" d="M170.4904,-101.6576C195.3118,-95.495 241.002,-84.1512 270.4161,-76.8484"/>
<polygon fill="#000000" stroke="#000000" points="271.5856,-80.1644 280.4476,-74.3578 269.8988,-73.3706 271.5856,-80.1644"/>
</g>
<!-- y1 -->
<g id="node8" class="node">
<title>y1</title>
<ellipse fill="none" stroke="#000000" cx="419" cy="-34" rx="18" ry="18"/>
<text text-anchor="middle" x="419" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">y3</text>
</g>
<!-- h21&#45;&gt;y1 -->
<g id="edge13" class="edge">
<title>h21-&gt;y1</title>
<path fill="none" stroke="#000000" d="M311.8802,-129.611C332.8502,-110.894 372.7803,-75.2539 397.5224,-53.1701"/>
<polygon fill="#000000" stroke="#000000" points="400.1518,-55.5146 405.2816,-46.2445 395.4905,-50.2923 400.1518,-55.5146"/>
</g>
<!-- y2 -->
<g id="node9" class="node">
<title>y2</title>
<ellipse fill="none" stroke="#000000" cx="419" cy="-178" rx="18" ry="18"/>
<text text-anchor="middle" x="419" y="-173.8" font-family="Times,serif" font-size="14.00" fill="#000000">y1</text>
</g>
<!-- h21&#45;&gt;y2 -->
<g id="edge14" class="edge">
<title>h21-&gt;y2</title>
<path fill="none" stroke="#000000" d="M315.3363,-147.1579C335.3733,-153.1193 368.5903,-163.0021 392.0145,-169.9713"/>
<polygon fill="#000000" stroke="#000000" points="391.1129,-173.3546 401.6958,-172.8516 393.1091,-166.6452 391.1129,-173.3546"/>
</g>
<!-- y3 -->
<g id="node10" class="node">
<title>y3</title>
<ellipse fill="none" stroke="#000000" cx="419" cy="-106" rx="18" ry="18"/>
<text text-anchor="middle" x="419" y="-101.8" font-family="Times,serif" font-size="14.00" fill="#000000">y2</text>
</g>
<!-- h21&#45;&gt;y3 -->
<g id="edge15" class="edge">
<title>h21-&gt;y3</title>
<path fill="none" stroke="#000000" d="M315.3363,-136.8421C335.3733,-130.8807 368.5903,-120.9979 392.0145,-114.0287"/>
<polygon fill="#000000" stroke="#000000" points="393.1091,-117.3548 401.6958,-111.1484 391.1129,-110.6454 393.1091,-117.3548"/>
</g>
<!-- h22&#45;&gt;y1 -->
<g id="edge16" class="edge">
<title>h22-&gt;y1</title>
<path fill="none" stroke="#000000" d="M315.3363,-64.8421C335.3733,-58.8807 368.5903,-48.9979 392.0145,-42.0287"/>
<polygon fill="#000000" stroke="#000000" points="393.1091,-45.3548 401.6958,-39.1484 391.1129,-38.6454 393.1091,-45.3548"/>
</g>
<!-- h22&#45;&gt;y2 -->
<g id="edge17" class="edge">
<title>h22-&gt;y2</title>
<path fill="none" stroke="#000000" d="M311.8802,-82.389C332.8502,-101.106 372.7803,-136.7461 397.5224,-158.8299"/>
<polygon fill="#000000" stroke="#000000" points="395.4905,-161.7077 405.2816,-165.7555 400.1518,-156.4854 395.4905,-161.7077"/>
</g>
<!-- h22&#45;&gt;y3 -->
<g id="edge18" class="edge">
<title>h22-&gt;y3</title>
<path fill="none" stroke="#000000" d="M315.3363,-75.1579C335.3733,-81.1193 368.5903,-91.0021 392.0145,-97.9713"/>
<polygon fill="#000000" stroke="#000000" points="391.1129,-101.3546 401.6958,-100.8516 393.1091,-94.6452 391.1129,-101.3546"/>
</g>
</g>
</svg>
</p><p><strong>2.</strong> Before the first hidden layer: <span class="mathjax-exps">$W_1 \cdot X + b_1$</span><br>
<span class="mathjax-exps">$\begin{bmatrix} w_111 &amp; w_121 \\ w_112 &amp; w_122 \\ w_113 &amp; w_123 \end{bmatrix} \cdot \begin{bmatrix} x_11 &amp; x_12 &amp; x_13\\ x_21 &amp; x_22 &amp; x_23 \end{bmatrix} + \begin{bmatrix} b_11 \\ b_12 \\ b_13 \end{bmatrix}$</span><br>
After the first hidden layer: <span class="mathjax-exps">$f(W_1 \cdot X + b_1)$</span> where <span class="mathjax-exps">$f()$</span> is ReLu function<br>
In similar manner, we have<br>
Before the second hidden layer: <span class="mathjax-exps">$W_2 \cdot f(W_1 \cdot X + b_1) + b_2$</span><br>
After the second hidden layer: <span class="mathjax-exps">$f(W_2 \cdot f(W_1 \cdot X + b_1) + b_2)$</span><br>
Before the output layer: <span class="mathjax-exps">$V \cdot f(W_2 \cdot f(W_1 \cdot X + b_1) + b_2) + c$</span><br>
After the output layer: <span class="mathjax-exps">$g(V \cdot f(W_2 \cdot f(W_1 \cdot X + b_1) + b_2) + c)$</span> where <span class="mathjax-exps">$g()$</span> is softmax function.</p>
<p><strong>3.</strong> Python function <strong>ff_nn_2_ReLu()</strong>:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># Rectified linear activation</span>
<span class="token keyword">def</span> <span class="token function">rect</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>z<span class="token punctuation">)</span>
    <span class="token keyword">return</span> r

<span class="token comment"># Softmax function    </span>
<span class="token keyword">def</span> <span class="token function">softmax</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> s

<span class="token keyword">def</span> <span class="token function">ff_nn_2_ReLu</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a1 <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W1<span class="token punctuation">,</span>X<span class="token punctuation">)</span><span class="token operator">+</span>b1
    h1 <span class="token operator">=</span> rect<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>
    a2 <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W2<span class="token punctuation">,</span>h1<span class="token punctuation">)</span><span class="token operator">+</span>b2
    h2 <span class="token operator">=</span> rect<span class="token punctuation">(</span>a2<span class="token punctuation">)</span>
    a3 <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>V<span class="token punctuation">,</span>h2<span class="token punctuation">)</span><span class="token operator">+</span>c
    y <span class="token operator">=</span> softmax<span class="token punctuation">(</span>a3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> y
</pre><p><strong>4.</strong> When we run <strong>ff_nn_2_ReLu()</strong>, we get:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">W1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
W2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
V <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

output <span class="token operator">=</span> ff_nn_2_ReLu<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info="" class="language-"><code>[[0.94649912 0.84379473 0.84379473]
 [0.04712342 0.1141952  0.1141952 ]
 [0.00637746 0.04201007 0.04201007]]
</code></pre><p>Note that each column of the resulting matrix represents the probabilities of each sample belonging to each class (i.e. each row represents class 1, 2, 3). In other words, each column represents the class probabilities associated with the forward pass of each sample and thus, adds up to 1. Since the first row has the largest probabilities for each column, all samples will be classified in class 1.</p>
<h4 class="mume-header" id="problem-2">Problem 2</h4>

<p><strong>1.</strong> The partial derivatives of f with respect to x and to y are:<br>
<span class="mathjax-exps">$\begin{aligned} \frac{\partial f}{\partial x} &amp;= \frac{\partial}{\partial x} ((1-x)^2+100(y-x^2)^2) = 2(1-x)(-1)+100(2)(y-x^2)(-2x) \\ &amp;= 2(x-1)+2(100(2x^3-2xy)) = 2(x-1)+2(200x^3-200xy) \\ &amp;= 2(200x^3-200xy+x-1) \\ \\ \frac{\partial f}{\partial y} &amp;= \frac{\partial}{\partial y} ((1-x)^2+100(y-x^2)^2) = 100(2)(y-x^2)(1) = 200(y-x^2) \end{aligned}$</span></p>
<p><strong>2.</strong> The visualization of the contours of the Rosenbrock function:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

delta <span class="token operator">=</span> <span class="token number">0.025</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">,</span>delta<span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span><span class="token number">3.0</span><span class="token punctuation">,</span>delta<span class="token punctuation">)</span>
X<span class="token punctuation">,</span> Y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
Z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span>Y<span class="token operator">-</span>X<span class="token operator">*</span>X<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
</pre><img src="rosenbrock.png">
<p><strong>3.</strong> Gradient Descent algorithm for finding the minimum of the function:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">grad_f</span><span class="token punctuation">(</span>vector<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y <span class="token operator">=</span> vector
    df_dx <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token operator">*</span>x<span class="token operator">**</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">200</span><span class="token operator">*</span>x<span class="token operator">*</span>y<span class="token operator">+</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    df_dy <span class="token operator">=</span> <span class="token number">200</span><span class="token operator">*</span><span class="token punctuation">(</span>y<span class="token operator">-</span>x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>df_dx<span class="token punctuation">,</span>df_dy<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">grad_descent</span><span class="token punctuation">(</span>iterations<span class="token punctuation">,</span> learning_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>
    point <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    trajectory <span class="token operator">=</span> <span class="token punctuation">[</span>point<span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        grad <span class="token operator">=</span> grad_f<span class="token punctuation">(</span>point<span class="token punctuation">)</span>
        point <span class="token operator">=</span> point<span class="token operator">-</span>learning_rate<span class="token operator">*</span>grad
        trajectory<span class="token punctuation">.</span>append<span class="token punctuation">(</span>point<span class="token punctuation">)</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>trajectory<span class="token punctuation">)</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0.004</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gd1.png">
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">0.002</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gd2.png">
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token number">0.002</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gd3.png">
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gd4.png">
<p>In the first figure, the learning rate is too large and we can clearly see that the optimizer oscillates to find the minimum, but gets stuck in the local minimum just in 10 iterations. As the learning rate decreases to 0.002, it tracks closer to the global minimum point of (1,1). Note that the orange point is the final point after 1000 iterations and the green point is the expected minimum. If we increase the number of iterations as in the third figure, it gets very close to our expected optimal point (i.e. orange point almost overlaps the green point). Lastly, we can see in the last figure that if we decrease the learning rate even more, we would need more iterations compared to the previous example (3000 iterations &amp; 0.002 learning rate) to get closer to the optimal because the step size is smaller.</p>
<p><strong>4.</strong> Gradient Descent With Momentum algorithm for finding the minimum:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">grad_descent_with_momentum</span><span class="token punctuation">(</span>iterations<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> epsilon<span class="token punctuation">)</span><span class="token punctuation">:</span>
    point <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    trajectory <span class="token operator">=</span> <span class="token punctuation">[</span>point<span class="token punctuation">]</span>
    v <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>point<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        grad <span class="token operator">=</span> grad_f<span class="token punctuation">(</span>point<span class="token punctuation">)</span>
        v <span class="token operator">=</span> alpha<span class="token operator">*</span>v<span class="token operator">+</span>epsilon<span class="token operator">*</span>grad
        point <span class="token operator">=</span> point<span class="token operator">-</span>v
        trajectory<span class="token punctuation">.</span>append<span class="token punctuation">(</span>point<span class="token punctuation">)</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>trajectory<span class="token punctuation">)</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.0005</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gdm1.png">
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.0005</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gdm2.png">
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.0005</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gdm3.png">
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>
traj <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
CS <span class="token operator">=</span> ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>Z<span class="token punctuation">)</span>
x <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> traj<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&apos;-o&apos;</span><span class="token punctuation">,</span>x<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">)</span>
</pre><img src="gdm4.png">
<p>Note that as alpha increases, the momentum speeds up the iterations and leads to faster convergence. This behavior is especially more noticeable in the first few iterations of the first, second, and third figures (i.e. as alpha increases, the starting point that the momentum term reduces updates for dimensions whose gradients change directions moves to right). Finally, in the last figure, as the value of epsilon becomes similar to the learning rate from the previous exercise, it gets even closer to the minimum. Therefore, with appropriate value of alpha and epsilon, Gradient Descent with Momentum algorithm finds the minimum in less number of iterations compared to Gradient Descent algorithm. Also, it did not get stuck  in local minimum.</p>
<h4 class="mume-header" id="problem-3">Problem 3</h4>

<p><strong>1.</strong> With same notations from part 1.2, we have<br>
<span class="mathjax-exps">$a_1 = W_1 \cdot X + b_1$</span><br>
<span class="mathjax-exps">$h_1 = f(W_1 \cdot X + b_1) = f(a_1)$</span> where <span class="mathjax-exps">$f()$</span> is ReLu function<br>
<span class="mathjax-exps">$a_2 = W_2 \cdot f(W_1 \cdot X + b_1) + b_2 = W_2 \cdot h_1 + b_2$</span><br>
<span class="mathjax-exps">$h_2 = f(W_2 \cdot f(W_1 \cdot X + b_1) + b_2) = f(a_2)$</span><br>
<span class="mathjax-exps">$a_3 = V \cdot f(W_2 \cdot f(W_1 \cdot X + b_1) + b_2) + c = V \cdot h_2 + c$</span><br>
<span class="mathjax-exps">$\hat{y} = g(V \cdot f(W_2 \cdot f(W_1 \cdot X + b_1) + b_2) + c) = g(a_3)$</span> where <span class="mathjax-exps">$g()$</span> is softmax function<br>
and the loss function<br>
<span class="mathjax-exps">$L(y,\hat{y}) = y_1 \log(\hat{y_1}) + y_2 \log(\hat{y_2}) + y_3 \log(\hat{y_3})$</span>.<br>
Therefore, the gradient of the Loss function at each steps are<br>
<span class="mathjax-exps">$\frac{\partial L}{\partial a_3} = \frac{\partial L}{\partial \hat{y}} \frac{\partial \hat{y}}{\partial a_3} = \hat{y}-y$</span><br>
<span class="mathjax-exps">$\frac{\partial L}{\partial h_2} = \frac{\partial L}{\partial \hat{y}} \frac{\partial \hat{y}}{\partial a_3} \frac{\partial a_3}{\partial h_2} = (\hat{y}-y) \cdot h_2$</span><br>
<span class="mathjax-exps">$\frac{\partial L}{\partial a_2} = \frac{\partial L}{\partial \hat{y}} \frac{\partial \hat{y}}{\partial a_3} \frac{\partial a_3}{\partial h_2} \frac{\partial h_2}{\partial a_2}= ((\hat{y}-y) \cdot V) (1(h_2&gt;0))$</span><br>
<span class="mathjax-exps">$\frac{\partial L}{\partial h_1} = \frac{\partial L}{\partial \hat{y}} \frac{\partial \hat{y}}{\partial a_3} \frac{\partial a_3}{\partial h_2} \frac{\partial h_2}{\partial a_2} \frac{\partial a_2}{\partial h_1}= ((((\hat{y}-y) \cdot V) (1(h_2&gt;0))) \cdot W_2)(1(h_1&gt;0))$</span><br>
<span class="mathjax-exps">$\frac{\partial L}{\partial a_1} = \frac{\partial L}{\partial \hat{y}} \frac{\partial \hat{y}}{\partial a_3} \frac{\partial a_3}{\partial h_2} \frac{\partial h_2}{\partial a_2} \frac{\partial a_2}{\partial h_1} \frac{\partial h_1}{\partial a_1 \text{wrt} w_1}= (((((\hat{y}-y) \cdot V) (1(h_2&gt;0))) \cdot W_2)(1(h_1&gt;0)))\cdot X$</span></p>
<p><strong>2.</strong> Python function <strong>grad_f()</strong>:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">def</span> <span class="token function">grad_f</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># rr_nn_2_ReLu from the previous part</span>
    a1 <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W1<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token operator">+</span>b1<span class="token punctuation">.</span>T
    h1 <span class="token operator">=</span> rect<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>
    a2 <span class="token operator">=</span> h1<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W2<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token operator">+</span>b2<span class="token punctuation">.</span>T
    h2 <span class="token operator">=</span> rect<span class="token punctuation">(</span>a2<span class="token punctuation">)</span>
    a3 <span class="token operator">=</span> h2<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>V<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token operator">+</span>c<span class="token punctuation">.</span>T
    y_hat <span class="token operator">=</span> softmax<span class="token punctuation">(</span>a3<span class="token punctuation">)</span>

    <span class="token comment"># backprop gradient</span>
    da3 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y_hat<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
    dh2 <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">(</span>y_hat<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span>h2<span class="token punctuation">)</span>
    da2t <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">(</span>y_hat<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>V<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>h2<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    da2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>da2t<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
    dh1 <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>da2t<span class="token punctuation">.</span>T<span class="token punctuation">,</span>h1<span class="token punctuation">)</span>
    da1t <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>da2t<span class="token punctuation">,</span>W2<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>h1<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    da1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>da1t<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
    out <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>da1t<span class="token punctuation">.</span>T<span class="token punctuation">,</span>X<span class="token punctuation">)</span>

    <span class="token keyword">return</span> y_hat<span class="token punctuation">,</span><span class="token punctuation">[</span>out<span class="token punctuation">,</span>da1<span class="token punctuation">,</span>dh1<span class="token punctuation">,</span>da2<span class="token punctuation">,</span>dh2<span class="token punctuation">,</span>da3<span class="token punctuation">]</span>
</pre><p><strong>3.</strong>  Plot of sample dataset:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span>
        <span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>multivariate_normal<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cov<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>multivariate_normal<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cov<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>multivariate_normal<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cov<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">)</span>
y<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
y<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">:</span><span class="token number">1500</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">)</span>
</pre><img src="scatter.png">
<p><strong>4.</strong> Fit the network using Gradient Descent:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">W1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
W2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
V <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
y <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
y<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
y<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">:</span><span class="token number">1500</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">rect</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>z<span class="token punctuation">)</span>
    <span class="token keyword">return</span> r

<span class="token keyword">def</span> <span class="token function">softmax</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
    <span class="token keyword">return</span> s

<span class="token keyword">def</span> <span class="token function">loss_f</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_hat<span class="token punctuation">)</span><span class="token punctuation">:</span>
    l <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token operator">-</span>y<span class="token operator">*</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_hat<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> l

<span class="token keyword">def</span> <span class="token function">grad_descent</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span>iterations<span class="token punctuation">,</span>learning_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>
    point <span class="token operator">=</span> <span class="token punctuation">[</span>W1<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>c<span class="token punctuation">]</span>
    traj <span class="token operator">=</span> <span class="token punctuation">[</span>point<span class="token punctuation">]</span>
    loss <span class="token operator">=</span> <span class="token punctuation">[</span>loss_f<span class="token punctuation">(</span>y<span class="token punctuation">,</span>grad_f<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        y_hat<span class="token punctuation">,</span>grad <span class="token operator">=</span> grad_f<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
        point <span class="token operator">=</span> np<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>point<span class="token punctuation">,</span> <span class="token punctuation">[</span>j<span class="token operator">*</span>learning_rate <span class="token keyword">for</span> j <span class="token keyword">in</span> grad<span class="token punctuation">]</span><span class="token punctuation">)</span>
        traj<span class="token punctuation">.</span>append<span class="token punctuation">(</span>point<span class="token punctuation">)</span>
        W1<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>c <span class="token operator">=</span> <span class="token punctuation">[</span>point<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        loss<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss_f<span class="token punctuation">(</span>y<span class="token punctuation">,</span>grad_f<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>traj<span class="token punctuation">)</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span>

traj1<span class="token punctuation">,</span>loss1 <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0.0005</span><span class="token punctuation">)</span>
traj2<span class="token punctuation">,</span>loss2 <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0.005</span><span class="token punctuation">)</span>
traj3<span class="token punctuation">,</span>loss3 <span class="token operator">=</span> grad_descent<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0.05</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss1<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;learning rate=0.0005&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss2<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;learning rate=0.005&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss3<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;learning rate=0.05&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>framealpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> frameon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;Iterations&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;RMS Error&quot;</span><span class="token punctuation">)</span>
</pre><img src="back1.png">
<p>When the learning rate is too large, we can actually see RMS error oscillating and it takes some time to converge, but RMS error is still very high. As the learning rate decreases and becomes an appropriate tuning parameter, the error stably converges (almost linear after first few iterations) to a smaller rate.</p>
<p><strong>5.</strong> Fit the network using Gradient Descent With Momentum:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">grad_descent_with_momentum</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span>iterations<span class="token punctuation">,</span>alpha<span class="token punctuation">,</span>epsilon<span class="token punctuation">)</span><span class="token punctuation">:</span>
    point <span class="token operator">=</span> <span class="token punctuation">[</span>W1<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>c<span class="token punctuation">]</span>
    traj <span class="token operator">=</span> <span class="token punctuation">[</span>point<span class="token punctuation">]</span>
    v <span class="token operator">=</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> point<span class="token punctuation">]</span>
    loss <span class="token operator">=</span> <span class="token punctuation">[</span>loss_f<span class="token punctuation">(</span>y<span class="token punctuation">,</span>grad_f<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        y_hat<span class="token punctuation">,</span>grad <span class="token operator">=</span> grad_f<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
        v <span class="token operator">=</span> np<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token punctuation">[</span>alpha<span class="token operator">*</span>j <span class="token keyword">for</span> j <span class="token keyword">in</span> v<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>epsilon<span class="token operator">*</span>k <span class="token keyword">for</span> k <span class="token keyword">in</span> grad<span class="token punctuation">]</span><span class="token punctuation">)</span>
        point <span class="token operator">=</span> point <span class="token operator">-</span> v
        traj<span class="token punctuation">.</span>append<span class="token punctuation">(</span>point<span class="token punctuation">)</span>
        W1<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>c <span class="token operator">=</span> <span class="token punctuation">[</span>point<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        loss<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss_f<span class="token punctuation">(</span>y<span class="token punctuation">,</span>grad_f<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>traj<span class="token punctuation">)</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span>

traj1<span class="token punctuation">,</span>loss1 <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.002</span><span class="token punctuation">)</span>
traj2<span class="token punctuation">,</span>loss2 <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.004</span><span class="token punctuation">)</span>
traj3<span class="token punctuation">,</span>loss3 <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.006</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss1<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;epsilon=0.002&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss2<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;epsilon=0.004&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss3<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;epsilon=0.006&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>framealpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> frameon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;Iterations&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;RMS Error&quot;</span><span class="token punctuation">)</span>
</pre><img src="back2.png">
<pre data-role="codeBlock" data-info="python" class="language-python">traj1<span class="token punctuation">,</span>loss1 <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>
traj2<span class="token punctuation">,</span>loss2 <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>
traj3<span class="token punctuation">,</span>loss3 <span class="token operator">=</span> grad_descent_with_momentum<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span>V<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>c<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss1<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;alpha=0.01&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss2<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;alpha=0.05&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss3<span class="token punctuation">,</span><span class="token string">&apos;o&apos;</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&apos;alpha=0.09&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>framealpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> frameon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;Iterations&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;RMS Error&quot;</span><span class="token punctuation">)</span>
</pre><img src="back3.png">
<p>Again, we see similar behavior as alpha and epsilon change respectively. Both algorithms converge quite efficiently if appropriate parameters are selected. Thus, it is always crucial to find appropriate tuning parameters for both methods. However, with momentum, RMS error converges in a path like the trajectory of bouncing ball. Instead of converging after zig-zagging in a constant step size, this could be less waste of iterations and thus, more efficient.</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>